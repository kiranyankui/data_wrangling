---
title: "DS HW2"
output: github_document
---

# Homework 2 

## Load Libraries 

```{r setup}
library(tidyverse)
library(readxl)
library(haven)
```

## Problem 1 

We want to read and clean the NYC transit dataset from the csv file. 

```{r Read/Clean Transit data}
NYC_transit = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names()

skimr::skim(NYC_transit)
```

Now, we want to retain the following variables:

* line
* station name
* station latitude / longitude
* routes served
* entry
* vending
* entrance type
* ADA compliance 

```{r retain variables}
select(NYC_transit, line, station_name, station_latitude, station_longitude, route1, route2, route3, route4, route5, route6, route7, route8, route9, route10, route11, entry, vending, entrance_type, ada)

NYC_transit
```


Converting the entry variable into a logical vector. 
```{r converting to logical vector}

recode(NYC_transit$entry, "YES"=TRUE,"NO"=FALSE, .default = NA)

NYC_transit
```

## Description about the NYC_transit dataset

1. The dataset contains 32 columns (variables) and 1868 rows  (observations). 

2. The variables from the dataset contains line, station_name, station_latitude, station_longitude, routes1 to 11, entry, vending, entrance_type, ada

division, line, station_name, routes, entrance type, entry, exit only, vending, staffing, staff hours, ADA notes, north south street, east west street, corner, station location, entrance location, ada, free crossover, station lattitude and longitude, and entrance lattitude and longitude. 

3. I read and clean object names using clean names () in janitor; retain line, station, name, station latitude / longitude, routes served, entry, vending, entrance type, and ADA compliance. Convert the entry variable from character (YES vs NO) to a logical variable

4. The data are tidy. 

Answer the following questions using these data:

* How many distinct stations are there? Note that stations are identified both by name and by line (e.g. 125th St 8th Avenue; 125st Broadway; 125st Lenox); the distinct function may be useful here.

```{r distinct stations}
nrow(distinct(NYC_transit, station_name))
```
Ans: There are 356 distinct stations. 

* How many stations are ADA compliant?

```{r distinct stations who are ada-compliant }
NYC_transit %>% 
  select(station_name, ada) %>% 
  filter(ada == TRUE) %>%
  distinct(station_name)

```

Ans: There are 73 distinct stations who are ADA-compliant. 

* What proportion of station entrances / exits without vending allow entrance?

```{r proportion of stations without vending allow entrance}
NYC_transit %>% 
  select(vending, entry) %>% 
  filter(entry == "YES", vending == "NO")

NYC_transit %>% 
  select(vending, entry) %>% 
  filter(vending == "NO")
```

69 station entrances do not have vending and allow entrance.
183 station entrances do not have vending. 

Ans: Proportion of station entrances / exits without vending allow entrance is (69/183)*100 = 37.70%. 

I am reformating data so that route number and route name are distinct variables. 

* How many distinct stations serve the A train? Of the stations that serve the A train, how many are ADA compliant?


## Problem 2    


```{r }

# read and clean the Mr Trash Wheel dataset from the excel file

Mr_Trash_df = read_excel("./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 
  sheet="Mr. Trash Wheel", 
  range = "A2:N535",
  skip = 1) %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  transform(sports_balls = as.integer(sports_balls)) 
```

I ensured the use of reasonable variable names. 
I have ommited rows that do not include dumpster-specific data. 
I have rounded the number of sports balls to the nearest integer and converted the result to an integer variable. 
I created an ID column (variable) to faciliate the merging of the two datasets. 

```{r }
# read and clean the Professor Trash Wheel dataset from the excel file

Pf_Trash_df = read_excel("./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 
  sheet = "Professor Trash Wheel",
  range = "A2:N117",
  skip = 1) %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  transform(sports_balls = as.integer(sports_balls)) %>%
  add_column(name = "Professor Trash Wheel") %>%
  mutate(dumpster = as.character(dumpster))
```


```{r}
# Joining the datasets for Mr Trash Wheel and Professor Trash Wheel
Both_Trash_df = 
  full_join(Mr_Trash_df, Pf_Trash_df)
```

__Mr Trash Wheel dataset (Mr_Trash_df)__
* there are `r ncol(Mr_Trash_df)` columns (variables) and `r nrow(Mr_Trash_df)` rows (observations)

__Professor Trash Wheel (Pf_Trash_df)__
* there are `r ncol(Pf_Trash_df)` columns (variables) and `r nrow(Pf_Trash_df)` rows (observations).

__combined dataset (Both_Trash_df)__
* There are `r ncol(Both_Trash_df)` columns (variables) and `r nrow(Both_Trash_df)` rows (observations). 
* This dataset includes the following variables: `r colnames(Both_Trash_df)`. 

This dataset contains:

* the weight of trash collected in tons
* number of trash items collected (plastic bottles, polystyrene, cigarette butts, grocery bags, glass bottles, chip bags, and sports balls)
* timing of trash collection by Mr Trash wheel and professor trash wheel

The total weight of trash collected by Professor Trash Wheel is `r sum(Pf_Trash_df$weight_tons)` tons. 

The total number of sports balls collected by Mr. Trash Wheel in 2020 is `r Mr_Trash_df %>% filter (year=="2020") %>% pull(sports_balls) %>% sum()` balls. 


## Problem 3

### Dataset for pols-month.csv

```{r}
pols_month_df = read_csv("./data/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(mon, into = c("year", "month", "day"), sep = '-') %>% 
  transform(month = as.numeric(month)) %>%
  
  pols_month_df %>%
  mutate(month = month.name[month])

skimr::skim(pols_month_df)
```

i have loaded and cleaned the data in pols-month.csv, as well as separated the column "mon" into "year", "month" and day". I also converted the "month" variable into a numeric variable. I replaced the month number with a month name.

```{r}
pols_month_df = pols_month_df %>%
     mutate(president = prez_gop + prez_dem) %>% 
    select(-prez_gop, -prez_dem, -day)

skimr::skim(pols_month_df)
```

I also created a president variable taking values gop and dem, and remove prez_dem and prez_gop; and remove the day variable.



### Dataset for snp.csv

```{r}
snp_df = read_csv("./data/snp.csv") %>% 
  janitor::clean_names() %>% 
  separate(date, into = c("month", "day", "year"), sep = '/') %>% 
  transform(month = as.numeric(month))

skimr::skim(snp_df)
```

i have loaded and cleaned the data in snp.csv, as well as separated the column "date" into "month", "day", "year". I also converted the "month" variable into a numeric variable. 


```{r}
snp_df %>%
  mutate(month = month.name[month])

skimr::skim(snp_df)
```

I replaced the month number with a month name.

### Tidying unemployment data


```{r}
unemp_df = read_csv("./data/unemployment.csv") %>% 
  janitor::clean_names() 
  
skimr::skim(unemp_df)
```

```{r}
unemp_tidy_df = 
  pivot_longer(
    unemp_df, 
    jan:dec,
    names_to = "month", 
    values_to = "persons")

skimr::skim(unemp_tidy_df)
```

```{r}
unemp_tidy_df %>% 
  transform(month = as.numeric(month))
```







